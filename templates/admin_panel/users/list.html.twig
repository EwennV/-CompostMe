{% extends 'base.html.twig' %}

{% block title %}Liste des utilisateurs - Panel administrateur | Compost &Me{% endblock %}

{% block body %}
<div class="d-flex d-inline-flex h-100 w-100">
    {% include 'admin_panel/side_panel.html.twig' %}
    <div class="p-2 pb-5 p-lg-4 w-100">
        <h1 class="title-underline">Liste des utilisateurs</h1>
        <div class="d-flex mb-3">
            <div
                    class="btn btn-primary ms-auto"
                    data-modal-toggle="form"
                    data-modal-title="Ajouter un nouvel utilisateur"
                    data-modal-href="{{ path('app_admin_panel_users_add') }}"
            >
                Ajouter un utilisateur
            </div>
        </div>
        <div class="table-responsive">
            {% if users|length > 0 %}
                <table class="table table-striped w-100" id="ticketTable">
                    <thead>
                    <tr>
                        <th></th>
                        <th scope="col" class="text-start">ID</th>
                        <th scope="col" style="min-width: 300px;">Pseudo</th>
                        <th scope="col" style="min-width: 300px;">Nom</th>
                        <th scope="col" style="min-width: 300px;">Prénom</th>
                        <th scope="col">Actions</th>
                    </tr>
                    </thead>
                    <tbody>
                    {% for user in users %}
                        <tr>
                            <th></th>
                            <td>{{ user.id }}</td>
                            <td><a href="#" class="text-wrap">{{ user.username }}</a></td>
                            <td>{{ user.lastname }}</td>
                            <td>{{ user.firstname }}</td>
                            <td>
                                <a href="#" class="btn btn-sm btn-primary">Voir</a>
                                <a href="#" class="btn btn-sm btn-danger">Supprimer</a>
                            </td>
                        </tr>
                    {% endfor %}
                    </tbody>
                </table>
            {% else %}
                <div class="text-center">
                    <img src="{{ asset('img/taken.svg') }}" alt="Aucun résultat" height="200px" class="m-2">
                    <p class="text-center">Aucun utilisateur n'a été trouvé</p>
                </div>
            {% endif %}
        </div>
        <link href="https://cdn.datatables.net/v/dt/jq-3.7.0/dt-2.0.3/r-3.0.1/datatables.min.css" rel="stylesheet">
        <script src="https://cdn.datatables.net/v/dt/jq-3.7.0/dt-2.0.3/r-3.0.1/datatables.min.js"></script>
        <script>
            let table = new DataTable('#ticketTable', {
                paging: true,
                searching: true,
                info: true,
                lengthChange: true,
                lengthMenu: [5, 10, 25, 50, 100],
                pageLength: 25,
                language: {
                    url: 'https://cdn.datatables.net/plug-ins/9dcbecd42ad/i18n/French.json'
                },
                autoWidth: true,
                responsive: {
                    details: {
                        type: 'column'
                    }
                },
                columnDefs: [
                    {
                        className: 'dtr-control',
                        orderable: false,
                        targets: 0
                    }
                ],
                order: [1, 'asc']
            })
        </script>

        {% endblock %}
